<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <title>資料輸入</title>
</head>

<body>

    <div class="container">
        <div class="text-center">
            <h1 class="h3 mb-3 fw-normal">用戶資料輸入</h1>
        </div>

        <div class="row justify-content-center">
            <div class="card text-center" style="width: 50rem;">
                <br />
                <label>裝置id</label>
                <input type="email" class="form-control" id="DeviceId" placeholder="Device Id">
                </br>
                <label>儀表板連結</label>
                <input type="password" class="form-control" id="url" placeholder="URL">
                </br>
                <label>Access token</label>
                <input type="access_token" class="form-control" id="AccessToken" placeholder="Access token">
                </br>
                <label>用戶住址</label>
                <input type="address" class="form-control" id="address" placeholder="用戶住址">

                <br />
                <div style="width: 48rem;">
                    <button1 class="btn btn-lg btn-primary" type="submit">資料送出</button1>
                </div>
                <br />
            </div>

        </div>
    </div>





</body>
<script>
   
   
    $(document).ready(function(){
      $("button1").click(function(){
        var getUrlString = location.href;
        var url = new URL(getUrlString);
        var linkToken = url.searchParams.get("linkToken");
        var UserId = url.searchParams.get("UserId");
        console.log($("#DeviceId").val());
        var obj = { "deviceId": $("#DeviceId").val(),"accessToken": $("#AccessToken").val(),"url": $("#url").val(),"address": $("#address").val()};
        console.log(obj);
        $.ajax({
            url: "https://linechatbot-ntouiot.herokuapp.com/robot/login?linkToken="+linkToken+"&UserId="+UserId, // ?="value" is RequestParam; /"value" is Pathvariable
            type: "POST",
            contentType:'application/json;charset=UTF-8',
            data:  JSON.stringify(obj),//RequestBody
            success: function(result){
                console.log(result);
                window.location.replace(result);
            }
        });
      });
    });

    
</script>

</html>
